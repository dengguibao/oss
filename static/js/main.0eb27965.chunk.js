(this.webpackJsonpdemo=this.webpackJsonpdemo||[]).push([[0],{559:function(e,t,a){},560:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(67),r=a.n(i),c=a(13),l=a(14),o=a(16),d=a(15),u=a(586),b=a(587),h=a(588),j=a(409),p=document.getElementById("api_url").getAttribute("value"),m=JSON.parse(window.sessionStorage.getItem("user_info")),f={domain:-1===p.indexOf("{{")?p:"http://10.10.4.6:8001",user_info:m};if(null!=m){var g=m.data.token;Object.assign(f,{request_headers:{headers:{Authorization:"token ".concat(g)}}})}var O,x,y,_,w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f;return e},v=Object(j.a)(w),k=a(576),S=a(571),C=a(575),I=a(197),R=a(109),B=a(76),q=a(431),F=a(218),D=a(578),P=a(27),A=a.n(P);function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function z(e,t){if(null==e)return{};var a,n,s=function(e,t){if(null==e)return{};var a,n,s={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}function L(e,t){var a=e.title,s=e.titleId,i=z(e,["title","titleId"]);return n.createElement("svg",N({xmlns:"http://www.w3.org/2000/svg",width:103,height:103,viewBox:"0 0 103 103",ref:t,"aria-labelledby":s},i),a?n.createElement("title",{id:s},a):null,"--\x3e\n",n.createElement("svg",N({xmlns:"http://www.w3.org/2000/svg",width:71,height:71,viewBox:"0 0 71 71",ref:t,"aria-labelledby":s},i),a?n.createElement("title",{id:s},a):null,O||(O=n.createElement("style",null,".a{fill:none;stroke-width:3;}")),x||(x=n.createElement("path",{d:"m12.2 1.7h8.6c5.7 0 10.3 4.4 10.3 9.9v9.4c0 2.7 0 9.9 0 9.9 0 0-7.5 0-10.3 0h-8.6C6.1 30.7 1.5 26.3 1.5 20.8v-9.4c0-2.7 0.1-9.8 0.1-9.8 0 0 7.4-0.1 10.2-0.1z",className:"a"})),y||(y=n.createElement("path",{d:"m59.5 1.7h-8.6c-5.7 0-10.3 4.4-10.3 9.9v9.4c0 2.7 0 9.9 0 9.9 0 0 7.5 0 10.3 0H59.1c5.7 0 10.3-4.4 10.3-9.9v-9.4c0-2.7-0.1-9.8-0.1-9.8 0 0-7.4-0.1-10.2-0.1z",className:"a"})),_||(_=n.createElement("path",{d:"m12.2 69.6h8.6c5.7 0 10.3-4.4 10.3-9.9v-9.4c0-2.7 0-9.9 0-9.9 0 0-7.5 0-10.3 0h-8.6c-5.7 0-10.3 4.4-10.3 9.9v9.4c0 2.7 0.1 9.8 0.1 9.8 0 0 7.4 0.1 10.2 0.1z",className:"a"})),n.createElement("path",{d:"m31.2 30.9v9.4a8.2 8.2 0 0 0 1.2 0.1 8.2 8.2 0 0 0 8.2-8.2 8.2 8.2 0 0 0-0.1-1.3z",style:{fill:"none",strokeLinejoin:"round",strokeWidth:3}})))}var M=n.forwardRef(L),U=(a.p,a.p+"static/media/ad.845cabc4.png"),T=a(42),E=a(117),V=a(577),K=a(275),G=a(569),H=a(582),Q=a(581),Y=a(139),J=a(158),W=a(585),Z=a(318),X=a(297),$=a(583),ee=a(574),te=a(138),ae=a(563),ne=a(300),se=a(433);function ie(e){if(0===e)return"0";var t=parseInt(100*e).toFixed();return t+="%"}function re(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("0"===e||isNaN(e)||void 0===e||0===e)return"0";var a=1024,n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.floor(Math.log(e)/Math.log(a)),i=(e/Math.pow(a,s)).toFixed(2);return t?i+" "+n[s]:i}function ce(){window.sessionStorage.setItem("user_info",null),window.location.reload()}var le=a(3),oe=Z.a.TabPane,de=function(e){return Object(le.jsxs)(X.a.Group,{buttonStyle:"solid",style:{marginTop:16},onChange:e.onChange,children:[Object(le.jsxs)($.b,{children:[Object(le.jsx)(X.a.Button,{style:{height:38,paddingTop:4},value:30,children:"1"}),Object(le.jsx)(X.a.Button,{style:{height:38,paddingTop:4},value:60,children:"2"}),Object(le.jsx)(X.a.Button,{style:{height:38,paddingTop:4},value:90,children:"3"}),Object(le.jsx)(X.a.Button,{style:{height:38,paddingTop:4},value:180,children:"6"}),Object(le.jsx)(X.a.Button,{style:{height:38,paddingTop:4,paddingLeft:11,paddingRight:11},value:365,children:"12"}),Object(le.jsx)(X.a.Button,{style:{height:38,paddingTop:4,paddingLeft:11,paddingRight:11},value:730,children:"24"}),Object(le.jsx)(X.a.Button,{style:{height:38,paddingTop:4,paddingLeft:11,paddingRight:11},value:1100,children:"36"})]}),Object(le.jsx)("span",{children:"Month"})]})},ue=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={amount:0},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(le.jsx)(X.a.Group,{buttonStyle:"solid",children:Object(le.jsxs)(I.a,{gutter:[8,14],children:[Object(le.jsx)(R.a,{span:6,children:Object(le.jsx)(X.a.Button,{style:{width:67},value:100,children:"100"})}),Object(le.jsx)(R.a,{span:6,children:Object(le.jsx)(X.a.Button,{style:{width:67},value:200,children:"200"})}),Object(le.jsx)(R.a,{span:6,children:Object(le.jsx)(X.a.Button,{style:{width:67},value:300,children:"300"})}),Object(le.jsx)(R.a,{span:6,children:Object(le.jsx)(X.a.Button,{style:{width:67},value:500,children:"500"})}),Object(le.jsx)(R.a,{span:6,children:Object(le.jsx)(X.a.Button,{value:1e3,children:"1000"})}),Object(le.jsx)(R.a,{span:6,children:Object(le.jsx)(X.a.Button,{value:2e3,children:"2000"})}),Object(le.jsx)(R.a,{span:6,children:Object(le.jsx)(X.a.Button,{value:3e3,children:"3000"})}),Object(le.jsx)(R.a,{span:6,children:Object(le.jsx)(X.a.Button,{value:5e3,children:"3000"})}),Object(le.jsx)(R.a,{span:24,children:Object(le.jsx)(ee.a,{style:{size:10},min:1,max:10,defaultValue:3})})]})})}}]),a}(n.Component),be=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).getAllRegionList=function(){A.a.get(n.globalState.domain+"/api/account/plan",{headers:n.globalState.request_headers.headers}).then((function(e){return n.setState({region_list:e.data.data})})).catch((function(e){e.response&&403===e.response.status&&window.sessionStorage.setItem("user_info",null)}))},n.globalState=v.getState(),n.state={region_list:[]},n.styles={itemField:{display:"inline-block",textAlign:"right",marginRight:"20px",fontSize:"12px"}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getAllRegionList()}},{key:"render",value:function(){var e=this;return Object(le.jsx)(X.a.Group,{buttonStyle:"solid",style:{marginTop:16},onChange:this.props.planChange,children:Object(le.jsx)(I.a,{gutter:8,children:this.state.region_list.map((function(t,a){return"e"!==t.state?null:Object(le.jsx)(R.a,{span:12,children:Object(le.jsxs)(I.a,{gutter:8,children:[Object(le.jsx)(R.a,{span:24,children:Object(le.jsx)(Q.a,{title:t.name,style:{marginBottom:8},children:Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:e.styles.itemField,children:"price"}),Object(le.jsx)("br",{}),"\xa0","storage"===e.props.type?t.s_price:t.b_price,"/d",Object(le.jsx)("br",{}),Object(le.jsx)("b",{style:e.styles.itemField,children:"Min purchase days"}),Object(le.jsx)("br",{}),"\xa0",t.plan_min_days,Object(le.jsx)("br",{}),Object(le.jsx)("br",{}),Object(le.jsx)("b",{style:e.styles.itemField,children:"offset"}),Object(le.jsx)("br",{}),"\xa0",ie(t.offset),Object(le.jsx)("br",{}),Object(le.jsx)("b",{style:e.styles.itemField,children:"Min purchase days"}),Object(le.jsx)("br",{}),"\xa0",t.offset_min_days,"/d"]})})}),Object(le.jsx)(R.a,{span:24,style:{textAlign:"center"},children:Object(le.jsx)(X.a.Button,{value:t.id,children:Object(le.jsx)(ne.a,{})})})]})},"plan_detail_"+a)}))})})}}]),a}(n.Component),he=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).submit=function(){s.formRef.submit()},s.formRef=Object(n.createRef)(),s}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(le.jsxs)(S.a,{ref:function(t){return e.formRef=t},layout:"vertical",onFinish:this.props.onFinish,children:[Object(le.jsx)(S.a.Item,{name:"bandwidth",label:"Bandwidth (M)",rules:[{required:!0,message:"please set you bandwidth"}],children:Object(le.jsx)(ee.a,{min:5,max:100,onChange:function(t){return e.formRef.setFieldsValue({capacity:t})}})}),Object(le.jsx)(S.a.Item,{name:"duration",label:"Duration (Month)",rules:[{required:!0,message:"please set you duration"}],children:Object(le.jsx)(de,{onChange:function(t){e.formRef.setFieldsValue({duration:t.target.value})}})}),Object(le.jsx)(S.a.Item,{name:"plan_id",label:"Plan",rules:[{required:!0,message:"please choice your plan"}],children:Object(le.jsx)(be,{type:"bandwidth",planChange:function(t){e.formRef.setFieldsValue({plan_id:t.target.value})}})})]})}}]),a}(n.Component),je=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).submit=function(){s.formRef.submit()},s.formRef=Object(n.createRef)(),s}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(le.jsxs)(S.a,{ref:function(t){return e.formRef=t},layout:"vertical",onFinish:this.props.onFinish,children:[Object(le.jsx)(S.a.Item,{name:"capacity",label:"Capacity (G)",rules:[{required:!0,message:"please set you capacity"}],children:Object(le.jsx)(ee.a,{min:40,max:40960,step:10,onChange:function(t){return e.formRef.setFieldsValue({capacity:t})}})}),Object(le.jsx)(S.a.Item,{name:"duration",label:"Duration (Month)",rules:[{required:!0,message:"please set you duration"}],children:Object(le.jsx)(de,{onChange:function(t){e.formRef.setFieldsValue({duration:t.target.value})}})}),Object(le.jsx)(S.a.Item,{name:"plan_id",label:"Plan",rules:[{required:!0,message:"please choice your plan"}],children:Object(le.jsx)(be,{type:"storage",planChange:function(t){e.formRef.setFieldsValue({plan_id:t.target.value})}})})]})}}]),a}(n.Component),pe=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).submit=function(){n.formRef.submit()},n.OnFinished=function(e){e.username=n.props.username,A.a.put(n.globalState.domain+"/api/user/set_password",e,n.globalState.request_headers).then((function(){n.props.logOut?ce():q.b.success("success")})).catch((function(e){e.response&&403===e.response.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.warning(e.response.data.detail)}))},n.globalState=v.getState(),n.formRef=s.a.createRef(),n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(le.jsx)("div",{children:Object(le.jsxs)(S.a,{ref:function(t){return e.formRef=t},layout:"vertical",onFinish:this.OnFinished,children:[Object(le.jsx)(S.a.Item,{name:"old_pwd",label:"Old Password",rules:[{required:!0,message:"Please input your old password!"}],hasFeedback:!0,children:Object(le.jsx)(C.a.Password,{placeholder:"password"})}),Object(le.jsx)(S.a.Item,{name:"pwd1",label:"New password",rules:[{required:!0,message:"Please input your new password!"}],hasFeedback:!0,children:Object(le.jsx)(C.a.Password,{placeholder:"password"})}),Object(le.jsx)(S.a.Item,{name:"pwd2",label:"Confirm Password",dependencies:["pwd"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your password!"},function(e){var t=e.getFieldValue;return{validator:function(e,a){return a&&t("pwd1")!==a?Promise.reject(new Error("The two passwords that you entered do not match!")):Promise.resolve()}}}],children:Object(le.jsx)(C.a.Password,{placeholder:"confirm password"})})]})})}}]),a}(n.Component),me=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleQuota=function(e){switch(e.target.innerText){case"Purchase storage capacity":n.setState({visible:!0,drawer_content:Object(le.jsx)(je,{onFinish:n.capacityQuotaOnFinished,ref:function(e){return n.Child=e}}),drawer_title:"Purchase Storage Capacity"});break;case"Purchase bandwidth":n.setState({visible:!0,drawer_content:Object(le.jsx)(he,{onFinish:n.bandwidthQuotaOnFinished,ref:function(e){return n.Child=e}}),drawer_title:"Purchase Download Bandwidth"})}},n.handleChangeKeys=function(){A.a.put(n.globalState.domain+"/api/user/keys",{allow_ip:"0.0.0.0"},n.globalState.request_headers).then((function(){return n.getUserDetail()})).catch((function(e){403===e.response.status&&window.sessionStorage.setItem("user_info",null)}))},n.onSubmit=function(){n.Child.submit()},n.capacityQuotaOnFinished=function(e){A.a.post(n.globalState.domain+"/api/user/quota/storage",e,n.globalState.request_headers).then((function(){return q.b.success("success")})).catch((function(e){e.response&&403===e.response.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.warning(e.response.data.detail)}))},n.bandwidthQuotaOnFinished=function(e){A.a.post(n.globalState.domain+"/api/user/quota/bandwidth",e,n.globalState.request_headers).then((function(){return q.b.success("success")})).catch((function(e){e.response&&403===e.response.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.warning(e.response.data.detail)}))},n.handleChangePassord=function(){n.setState({visible:!0,drawer_content:Object(le.jsx)(pe,{username:n.globalState.user_info.data.username,ref:function(e){return n.Child=e},logOut:!0}),drawer_title:"change password"})},n.closeDrawer=function(){n.setState({visible:!1}),n.getUserDetail()},n.getUserDetail=function(){A.a.get(n.globalState.domain+"/api/user/detail",{params:{user_id:n.globalState.user_info.data.user_id},headers:n.globalState.request_headers.headers}).then((function(e){n.setState({data:e.data.data,user_profile:e.data.data.profile,api_keys:e.data.data.keys,bandwidth_quota:e.data.data.bandwidth_quota,capacity_quota:e.data.data.capacity_quota})}))},n.globalState=v.getState(),n.state={data:{},user_profile:{},api_keys:{},bandwidth_quota:{},capacity_quota:{},visible:!1,drawer_content:null},n.Child=s.a.createRef(),n.style={itemField:{width:"200px",display:"inline-block"}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getUserDetail()}},{key:"render",value:function(){return Object(le.jsxs)(Q.a,{title:"About Me",children:[Object(le.jsxs)(Z.a,{defaultActiveKey:"1",children:[Object(le.jsx)(oe,{tab:"Basic",children:Object(le.jsxs)(Q.a,{children:[Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"Account Balance"}),this.state.user_profile.balance,Object(le.jsx)(B.a,{type:"link",onClick:function(){return k.a.info({title:"recharge",content:Object(le.jsx)(ue,{})})},children:"recharge"})]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"UserName"}),this.state.data.username]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"Name"}),this.state.data.first_name]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"Mail"}),this.state.data.email]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"User Class"}),this.state.data.is_superuser?"SuperUser":"Normal"]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"User Type"}),this.state.user_profile.is_subuser?"Sub User":"Normal"]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"Mail"}),this.state.user_profile.phone]}),Object(le.jsx)("p",{children:Object(le.jsx)(B.a,{type:"link",style:{padding:"0"},onClick:this.handleChangePassord,children:"change password"})})]})},"1"),Object(le.jsx)(oe,{tab:"Quota",children:Object(le.jsxs)(Q.a,{children:[Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"Bandwidth"}),this.state.bandwidth_quota.bandwidth,"M"]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"Status"}),this.state.bandwidth_quota.expired?Object(le.jsxs)(te.a,{title:"restore to default bandwidth",children:[Object(le.jsx)("span",{style:{color:"#e00"},children:"Expired"}),"\xa0",Object(le.jsx)(se.a,{})]}):"Normal"]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"End time"}),this.state.bandwidth_quota.deadline?this.state.bandwidth_quota.deadline.substr(0,16):""]}),Object(le.jsx)("p",{children:Object(le.jsx)(B.a,{type:"link",style:{padding:"0"},onClick:this.handleQuota,children:"Purchase bandwidth"})}),Object(le.jsx)(ae.a,{}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"Capacity"}),this.state.capacity_quota.capacity,"G"]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"Status"}),this.state.capacity_quota.expired?Object(le.jsx)("span",{style:{color:"#e00"},children:"Expired"}):"Normal"]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"End time"}),this.state.capacity_quota.deadline?this.state.capacity_quota.deadline.substr(0,16):""]}),Object(le.jsx)("p",{children:Object(le.jsx)(B.a,{type:"link",style:{padding:"0"},onClick:this.handleQuota,children:"Purchase storage capacity"})})]})},"2"),Object(le.jsx)(oe,{tab:"API Key",children:Object(le.jsxs)(Q.a,{children:[Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"Access Key"}),this.state.api_keys.user_access_key]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"Secret Key"}),this.state.api_keys.user_secret_key]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.style.itemField,children:"Server"}),this.globalState.domain]}),Object(le.jsx)("p",{children:Object(le.jsx)(B.a,{type:"link",style:{padding:"0"},onClick:this.handleChangeKeys,children:"change keys"})})]})},"3")]}),Object(le.jsx)(D.a,{visible:this.state.visible,width:"500px",title:this.state.drawer_title,placement:"right",closable:!0,onClose:this.closeDrawer,footer:Object(le.jsx)("div",{style:{textAlign:"right"},children:Object(le.jsx)(B.a,{onClick:this.onSubmit,type:"primary",children:"Submit"})}),children:this.state.drawer_content})]})}}]),a}(n.Component),fe={field:{display:"inline-block",width:100,textAlign:"right",marginRight:20}},ge=function(e){return Object(le.jsxs)(E.a,{onClick:function(t){return e.moreMenuEvent(t,e)},children:[Object(le.jsx)(E.a.Item,{children:"Detail"},"user_detail"),Object(le.jsx)(E.a.Item,{children:"Password"},"set_password"),Object(le.jsx)(E.a.Divider,{}),Object(le.jsx)(E.a.Item,{danger:!0,children:"Delete"},"delete_user")]})},Oe=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).getUserDetail=function(e){A.a.get(n.globalState.domain+"/api/user/detail",{params:{user_id:e},headers:n.globalState.request_headers.headers}).then((function(e){var t=e.data.data;console.log(t),n.setState({basic:t,profile:t.profile,bandwidth:t.bandwidth_quota,capacity:t.capacity_quota,keys:t.keys})}))},n.globalState=v.getState(),n.state={basic:{},bandwidth:{},capacity:{},profile:{},keys:{}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getUserDetail(this.props.userId)}},{key:"render",value:function(){return Object(le.jsxs)(V.a,{defaultActiveKey:["1"],children:[Object(le.jsxs)(V.a.Panel,{header:"Basic",children:[Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:fe.field,children:"balance"}),this.state.profile.balance]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:fe.field,children:"username"}),this.state.basic.username]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:fe.field,children:"name"}),this.state.basic.first_name]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:fe.field,children:"email"}),this.state.basic.email]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:fe.field,children:"phone"}),this.state.profile.phone]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:fe.field,children:"real used"}),re(this.state.basic.user_used)]})]},"1"),Object(le.jsxs)(V.a.Panel,{header:"Quota",children:[Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:fe.field,children:"bandwidth"}),this.state.bandwidth.bandwidth,"M"]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:fe.field,children:"expire"}),this.state.bandwidth.expired?"Expired":"Normal"]}),Object(le.jsx)("br",{}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:fe.field,children:"storage"}),this.state.capacity.capacity,"G"]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:fe.field,children:"expire"}),this.state.capacity.expired?"Expired":"Normal"]})]},"2"),Object(le.jsx)(V.a.Panel,{header:"Keys",children:Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:fe.field,children:"Ceph Uid"}),this.state.keys.ceph_uid]})},"3")]})}}]),a}(s.a.Component),xe=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).userColumns=[{title:"UserName",dataIndex:"username"},{title:"Name",dataIndex:"first_name"},{title:"Telephone",dataIndex:"profile.phone",render:function(e,t){return t.profile.phone}},{title:"Phone Validated",dataIndex:"profile.phone_verify",render:function(e,t){return t.profile.phone_verify?"Yes":"No"}},{title:"Date joined",dataIndex:"date_joined",render:function(e,t){return e.substr(0,16)}},{title:"Last login",dataIndex:"last_login",render:function(e,t){return e?e.substr(0,16):""}},{title:"Action",dataIndex:"id",render:function(e,t){return t.moreMenuEvent=n.handleMoreMenuEvent,Object(le.jsx)(s.a.Fragment,{children:n.props.type===n.globalState.user_info.data.user_type?Object(le.jsx)(K.a,{overlay:ge.bind(Object(T.a)(n),t),trigger:["click"],children:Object(le.jsxs)("a",{className:"ant-dropdown-link",onClick:function(e){return e.preventDefault()},children:["more",Object(le.jsx)(Y.a,{})]})}):Object(le.jsx)(B.a,{type:"link",onClick:function(){return n.handleBtnRemoveUser(t)},children:"Delete"})})}}],n.getUserList=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;void 0!==e&&(n.url+="&username="+e),A.a.get(n.url,{headers:n.globalState.request_headers.headers}).then((function(e){return n.setState({user_list:e.data.data,rs_count:e.data.page_info.record_count,current_page:e.data.page_info.current_page})})).catch((function(e){e.response&&403===e.response.status&&window.sessionStorage.setItem("user_info",null)}))},n.removeUser=function(e){A.a.delete(n.globalState.domain+"/api/user/delete",{data:{username:e.username,user_id:e.id},headers:n.globalState.request_headers.headers}).then((function(){q.b.success("success"),n.getUserList()})).catch((function(e){e.response&&403===e.response.data.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.warning(e.response.data.detail)}))},n.handleBtnRemoveUser=function(e){k.a.confirm({icon:Object(le.jsx)(J.a,{}),title:"warning",okType:"danger",content:"Deleting user will be destroy all related data",onOk:function(){n.removeUser(e)}})},n.handlePageChange=function(e){n.getUserList(e)},n.handleMoreMenuEvent=function(e,t){switch(e.key){case"delete_user":n.handleBtnRemoveUser(t);break;case"set_password":n.setState({visible:!0,drawer_title:"Setting password",drawer_foot:n.drawer_footer(),drawer_content:Object(le.jsx)(pe,{username:t.username,ref:function(e){return n.drawerRef=e}})});break;case"user_detail":n.setState({visible:!0,drawer_title:"User Detail Information",drawer_content:Object(le.jsx)(Oe,{userId:t.id})})}},n.drawer_footer=function(){return Object(le.jsx)("div",{style:{textAlign:"right"},children:Object(le.jsx)(B.a,{onClick:function(){return n.drawerRef?n.drawerRef.submit():n.setState({visible:!1})},type:"primary",children:"Submit"})})},n.onClose=function(){n.setState({visible:!1,drawer_content:null,drawer_foot:null})},n.globalState=v.getState(),n.drawerRef=s.a.createRef(),n.state={user_list:[],current_page:1,page_size:10,rs_count:1,visible:!1,drawer_content:null,drawer_title:null,drawer_foot:null},n.url="".concat(n.globalState.domain,"/api/user/list_user?page=").concat(n.state.current_page,"&size=").concat(n.state.page_size),"subuser"===n.props.type&&(n.url=n.url+"&subuser=1"),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getUserList(),"superuser"===this.props.type&&this.userColumns.splice(4,0,{title:"Storage Quota",dataIndex:"capacity_quota.capacity",render:function(e,t){return 0===t.capacity_quota.capacity?"0":t.capacity_quota.capacity+"G"}})}},{key:"render",value:function(){return Object(le.jsxs)(s.a.Fragment,{children:[Object(le.jsx)(G.a,{dataSource:this.state.user_list,pagination:{current:this.state.current_page,pageSize:this.state.page_size,total:this.state.rs_count,onChange:this.handlePageChange},columns:this.userColumns,rowKey:function(e){return e.id}}),Object(le.jsx)(D.a,{destroyOnClose:!0,visible:this.state.visible,width:"400px",title:this.state.drawer_title,placement:"right",closable:!0,onClose:this.onClose,footer:this.state.drawer_foot,children:this.state.drawer_content})]})}}]),a}(n.Component),ye=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleUpdateImg=function(){n.setState({img_url:n.globalState.domain+"/api/captcha?ts="+(new Date).valueOf()})},n.submit=function(){n.formRef.submit(),n.handleUpdateImg()},n.onFinish=function(e){var t=n.globalState.domain+"/api/user/register";"subuser"===n.props.type&&(t+="?sub_user=1"),A.a.post(t,e,"subuser"===n.props.type?n.globalState.request_headers:{}).then((function(e){q.b.success("success"),n.props.onSuccess()})).catch((function(e){q.b.warning(e.response.data.detail)}))},n.globalState=v.getState(),n.formRef=s.a.createRef(),n.state={img_url:n.globalState.domain+"/api/captcha"},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(le.jsx)("div",{children:Object(le.jsxs)(S.a,{ref:function(t){return e.formRef=t},layout:"vertical",onFinish:this.onFinish,children:[Object(le.jsx)(S.a.Item,{name:"first_name",rules:[{required:!0,message:"Please input your name!"}],label:"Name",children:Object(le.jsxs)(I.a,{gutter:[8,8],children:[Object(le.jsx)(R.a,{span:24,children:Object(le.jsx)(C.a,{placeholder:"name"})}),Object(le.jsx)(R.a,{span:24,children:Object(le.jsx)(H.a,{description:"first name, max length 8 characters",type:"info"})})]})}),Object(le.jsx)(S.a.Item,{name:"username",rules:[{required:!0,message:"Please input your username!"}],label:"UserName",children:Object(le.jsxs)(I.a,{gutter:[8,8],children:[Object(le.jsx)(R.a,{span:24,children:Object(le.jsx)(C.a,{placeholder:"username"})}),Object(le.jsx)(R.a,{span:24,children:Object(le.jsx)(H.a,{description:"login username, 6-20 characters",type:"info"})})]})}),Object(le.jsx)(S.a.Item,{name:"email",label:"E-mail",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}],children:Object(le.jsx)(C.a,{placeholder:"email"})}),Object(le.jsx)(S.a.Item,{name:"pwd",label:"Password",rules:[{required:!0,message:"Please input your password!"}],hasFeedback:!0,children:Object(le.jsx)(C.a.Password,{placeholder:"password"})}),Object(le.jsx)(S.a.Item,{name:"confirm",label:"Confirm Password",dependencies:["pwd"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your password!"},function(e){var t=e.getFieldValue;return{validator:function(e,a){return a&&t("pwd")!==a?Promise.reject(new Error("The two passwords that you entered do not match!")):Promise.resolve()}}}],children:Object(le.jsx)(C.a.Password,{placeholder:"confirm password"})}),Object(le.jsx)(S.a.Item,{name:"phone",rules:[{required:!0,message:"Please input your telephone!"}],label:"Telephone",children:Object(le.jsx)(C.a,{placeholder:"telephone"})}),Object(le.jsx)(S.a.Item,{name:"verify_code",rules:[{required:!0,message:"Please input your captcha code!"}],label:"Verification code",children:Object(le.jsxs)(I.a,{gutter:16,children:[Object(le.jsx)(R.a,{span:16,children:Object(le.jsx)(C.a,{placeholder:"Verification code"})}),Object(le.jsx)(R.a,{span:8,children:Object(le.jsx)("img",{alt:"verify img",src:this.state.img_url,onClick:this.handleUpdateImg,style:{width:100,height:32}})})]})})]})})}}]),a}(n.Component),_e=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onSubmit=function(){n.newUserRef.submit()},n.handleOpenDrawer=function(){n.setState({visible:!0})},n.handleCloseDrawer=function(){n.setState({visible:!1})},n.subComponentSuccess=function(){n.handleCloseDrawer(),n.usersRef.getUserList()},n.globalState=v.getState(),n.state={visible:!1},n.newUserRef=s.a.createRef(),n.usersRef=s.a.createRef(),n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(le.jsxs)(Q.a,{title:"Sub Users",children:[Object(le.jsxs)(B.a,{type:"primary",style:{marginBottom:"20px"},onClick:this.handleOpenDrawer,children:[Object(le.jsx)(W.a,{}),"Add sub user"]}),Object(le.jsx)(xe,{ref:function(t){return e.usersRef=t},type:"subuser"}),Object(le.jsx)(D.a,{destroyOnClose:!0,width:"400px",title:"New sub user",placement:"right",closable:!0,onClose:this.handleCloseDrawer,visible:this.state.visible,footer:Object(le.jsx)("div",{style:{textAlign:"right"},children:Object(le.jsx)(B.a,{onClick:this.onSubmit,type:"primary",children:"Submit"})}),children:Object(le.jsx)(ye,{onSuccess:this.subComponentSuccess,ref:function(t){return e.newUserRef=t},type:"subuser"})})]})}}]),a}(n.Component),we={wrap:{width:"950px",margin:"auto",padding:"20px"},head:{width:"950px",height:"80px",paddingLeft:"20px"},left:{float:"left",width:"350px",padding:"25px"},right:{float:"left",width:"550px",height:"500px",padding:"25px",overflow:"hidden"}},ve=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onRemember=function(e){e.target.checked?window.localStorage.setItem("remember","1"):window.localStorage.removeItem("remember")},n.onFinish=function(e){A.a.post("".concat(n.globalState.domain,"/api/user/login"),e).then((function(t){window.sessionStorage.setItem("user_info",JSON.stringify(t.data)),e.remember&&(window.localStorage.setItem("username",e.username),window.localStorage.setItem("password",e.password)),window.location.reload()})).catch((function(e){return e.response?(k.a.warning({title:"login failed",content:e.response.data.detail}),!1):(k.a.error({title:"login failed",content:"connect to server is timeout!"}),!1)}))},n.globalState=v.getState(),n.drawerRef=s.a.createRef(),n.remember="1"===window.localStorage.getItem("remember"),n.formRef=s.a.createRef(),n.login_info={username:window.localStorage.getItem("username"),password:window.localStorage.getItem("password"),remember:n.remember},n.state={visible:!1},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(le.jsxs)(S.a,{name:"login",className:"login-form",ref:function(t){return e.formRef=t},initialValues:{remember:this.login_info.remember,username:this.login_info.username,password:this.login_info.password},layout:"vertical",onFinish:this.onFinish,children:[Object(le.jsx)(S.a.Item,{name:"username",rules:[{required:!0,message:"Please input your Username!"}],label:"Username",children:Object(le.jsx)(C.a,{prefix:Object(le.jsx)(u.a,{}),placeholder:"Username"})}),Object(le.jsx)(S.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your Password!"}],children:Object(le.jsx)(C.a,{prefix:Object(le.jsx)(b.a,{}),type:"password",placeholder:"******"})}),Object(le.jsx)(S.a.Item,{children:Object(le.jsx)(S.a.Item,{label:"Verification code",name:"verify_code",rules:[{required:!0,message:"Please input your phone verification code!"}],children:Object(le.jsxs)(I.a,{gutter:6,children:[Object(le.jsx)(R.a,{span:14,children:Object(le.jsx)(C.a,{prefix:Object(le.jsx)(h.a,{}),placeholder:"verification code"})}),Object(le.jsx)(R.a,{span:10,children:Object(le.jsx)(B.a,{type:"primary",style:{padding:"4px 12px"},onClick:function(){var t=e.formRef.getFieldValue("username");null!==t&&0!==t.trim().length?A.a.get(e.globalState.domain+"/api/user/send_verify_code",{params:{username:t}}).then((function(){return q.b.info("message sent successfully")})).catch((function(e){e.response&&q.b.error(e.response.data.detail)})):q.b.info("please input your username")},children:"Send Message"})})]})})}),Object(le.jsx)(S.a.Item,{children:Object(le.jsx)(S.a.Item,{name:"remember",valuePropName:"checked",noStyle:!0,children:Object(le.jsx)(F.a,{onChange:this.onRemember,children:"Remember me"})})}),Object(le.jsxs)(S.a.Item,{children:[Object(le.jsx)(B.a,{type:"primary",htmlType:"submit",className:"login-form-button",children:"Log in"}),"\xa0Or ",Object(le.jsx)(B.a,{type:"link",style:{padding:0},onClick:function(){return e.setState({visible:!0})},children:"register now!"})]}),Object(le.jsx)(D.a,{visible:this.state.visible,width:"400px",title:"User register",placement:"right",closable:!0,onClose:function(){e.setState({visible:!1})},footer:Object(le.jsx)("div",{style:{textAlign:"right"},children:Object(le.jsx)(B.a,{onClick:function(){return e.drawerRef.submit()},type:"primary",children:"Submit"})}),children:Object(le.jsx)(ye,{onSuccess:function(){return e.setState({visible:!1})},ref:function(t){return e.drawerRef=t}})})]})}}]),a}(s.a.Component),ke=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return Object(le.jsxs)("div",{style:we.wrap,children:[Object(le.jsx)("div",{style:we.head,children:Object(le.jsx)(M,{width:80,stroke:"#a80"})}),Object(le.jsx)("div",{style:we.left,children:Object(le.jsx)(ve,{})}),Object(le.jsx)("div",{style:we.right,children:Object(le.jsx)("img",{alt:"logo",src:U})})]})}}]),a}(s.a.Component),Se=a(564),Ce=a(600),Ie=a(4),Re=a(580),Be=a(572),qe=a(565),Fe=a(567),De=a(568),Pe=Se.a,Ae=Z.a.TabPane,Ne=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).getClusterUsage=function(){A.a.get(n.globalState.domain+"/api/user/cluster_usage",{headers:n.globalState.request_headers.headers}).then((function(e){n.setState({pie_data:e.data.data,percent:e.data.allocate_total/e.data.license_capacity,used_total:e.data.used_total})}))},n.liquidConfig={height:200,outline:{border:4,distance:10},wave:{length:128}},n.globalState=v.getState(),n.state={pie_data:[],percent:0,used_total:0},n}return Object(l.a)(a,[{key:"shouldComponentUpdate",value:function(e,t,a){return t!==this.state}},{key:"componentDidMount",value:function(){this.getClusterUsage()}},{key:"render",value:function(){return Object(le.jsxs)(I.a,{gutter:10,style:{marginTop:10},children:[Object(le.jsx)(R.a,{span:8,children:Object(le.jsx)(Q.a,{title:"Unallocated",children:Object(le.jsx)(qe.a,Object(Ie.a)(Object(Ie.a)({},this.liquidConfig),{},{percent:this.state.percent}))})}),Object(le.jsx)(R.a,{span:8,children:Object(le.jsx)(Q.a,{title:"Bucket distribution",children:Object(le.jsx)(Fe.a,{height:200,angleField:"bucket_total",colorField:"region_name",data:this.state.pie_data,label:{type:"inner",offset:"-30%",content:function(e){var t=e.percent;return"".concat((100*t).toFixed(0),"%")},style:{fontSize:14,textAlign:"center"}},interactions:[{type:"element-active"}]})})}),Object(le.jsx)(R.a,{span:8,children:Object(le.jsx)(Q.a,{title:"Real used",children:Object(le.jsx)(Fe.a,{height:200,angleField:"file_size_total",colorField:"region_name",innerRadius:.6,data:this.state.pie_data,label:{type:"inner",offset:"-50%",content:function(e){var t=e.percent;return"".concat((100*t).toFixed(0),"%")},style:{fontSize:14,textAlign:"center"}},statistic:{title:!1,content:{style:{whiteSpace:"pre-wrap",overflow:"hidden",textOverflow:"ellipsis"},content:this.state.used_total+"G"}},interactions:[{type:"element-active"}]})})})]})}}]),a}(n.Component),ze=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).buildLastWeekDate=function(){var e=new Date,t=new Date(e-2592e6),a=t.getFullYear(),n=t.getMonth()+1;return n>=1&&n<=9&&(n="0"+n),a+"-"+n+"-"+t.getDate()},n.globalState=v.getState(),n.state={summary_data:{capacity:0,c_expired:!1,bandwidth:0,b_expired:!1,balance:0,buckets:0},usage_times:[],usage_bytes:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.buildLastWeekDate(),a=this.globalState.user_info.data.user_id,n=this.globalState.user_info.data.username,s=A.a.get(this.globalState.domain+"/api/user/detail",{params:{user_id:a},headers:this.globalState.request_headers.headers}).then((function(t){e.setState({summary_data:{capacity:t.data.data.capacity_quota.capacity,c_expired:t.data.data.capacity_quota.expired,bandwidth:t.data.data.bandwidth_quota.bandwidth,b_expired:t.data.data.bandwidth_quota.expired,balance:t.data.data.profile.balance,buckets:t.data.data.bucket.length}})})),i=A.a.get(this.globalState.domain+"/api/user/usage",{params:{username:n,start:t},headers:this.globalState.request_headers.headers}).then((function(t){var a=[],n=[];t.data.data.map((function(e){return a.push({date:e.date,value:e.usage.put_obj.successful_ops,category:"put"}),a.push({date:e.date,value:e.usage.get_obj.successful_ops,category:"get"}),n.push({date:e.date,value:e.usage.put_obj.bytes_received,category:"put"}),n.push({date:e.date,value:e.usage.get_obj.bytes_sent,category:"get"}),!1})),e.setState({usage_times:a,usage_bytes:n})}));Promise.all([s,i]).catch((function(e){e.response&&403===e.response.data.status&&(window.sessionStorage.setItem("user_info",null),window.location.reload())}))}},{key:"render",value:function(){return Object(le.jsxs)(Pe,{style:{padding:"0 50px"},children:[Object(le.jsxs)(Re.a,{style:{margin:"16px 0"},children:[Object(le.jsx)(Re.a.Item,{children:"Home"}),Object(le.jsx)(Re.a.Item,{children:"Summary"})]}),Object(le.jsx)(Se.a,{className:"site-layout-background",style:{padding:"24px 0"},children:Object(le.jsxs)(Pe,{style:{minHeight:280},children:[Object(le.jsx)("div",{style:{borderLeft:"5px solid #0055af",height:"50px",lineHeight:"50px",fontSize:"14px",marginBottom:"10px",paddingLeft:"10px",background:"white"},children:"hello ".concat(this.globalState.user_info.data.first_name,", welcome login")}),Object(le.jsxs)(I.a,{gutter:[10,10],children:[Object(le.jsx)(R.a,{span:6,children:Object(le.jsx)(Q.a,{children:Object(le.jsx)(Be.a,{title:"Buckets",value:this.state.summary_data.buckets})})}),Object(le.jsx)(R.a,{span:6,children:Object(le.jsx)(Q.a,{children:Object(le.jsx)(Be.a,{title:"Account Balance (CNY)",value:this.state.summary_data.balance,precision:2})})}),Object(le.jsx)(R.a,{span:6,children:Object(le.jsx)(Q.a,{children:Object(le.jsx)(Be.a,{title:"User Capacity",value:this.state.summary_data.capacity,valueStyle:{color:this.state.summary_data.c_expired?"#cf1322":"#000000"},suffix:"G"})})}),Object(le.jsx)(R.a,{span:6,children:Object(le.jsx)(Q.a,{children:Object(le.jsx)(Be.a,{title:"Bandwidth",value:this.state.summary_data.bandwidth,valueStyle:{color:this.state.summary_data.b_expired?"#cf1322":"#000000"},suffix:"M"})})})]}),"superuser"===this.globalState.user_info.data.user_type?Object(le.jsx)(Ne,{}):null,Object(le.jsx)(Q.a,{title:"Frequency of used",style:{marginTop:10},children:Object(le.jsxs)(Z.a,{defaultActiveKey:"1",children:[Object(le.jsx)(Ae,{tab:"Times",children:Object(le.jsx)(De.a,{height:300,xField:"date",yField:"value",smooth:!0,seriesField:"category",point:{size:5,shape:"diamond"},data:this.state.usage_times})},"1"),Object(le.jsx)(Ae,{tab:"Bytes",children:Object(le.jsx)(De.a,{height:300,xField:"date",yField:"value",seriesField:"category",smooth:!0,point:{size:5,shape:"diamond"},yAxis:{label:{formatter:function(e){return re(e)}}},tooltip:{formatter:function(e){return{name:e.category,value:re(e.value)}}},data:this.state.usage_bytes})},"2")]})})]})})]})}}]),a}(n.Component),Le=a(435),Me=a(307),Ue=a(432),Te=a(590),Ee=a(220),Ve=a(591),Ke=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).queryPermission=function(e){A.a.get(n.url.get+e,n.globalState.request_headers).then((function(e){n.setState({default:e.data.permission,explain:n.explain[e.data.permission.replaceAll("-","_")]})}))},n.handlePermBtnClick=function(e){n.setState({default:e.target.value,explain:n.explain[e.target.value.replaceAll("-","_")]})},n.submit=function(){A.a.put(n.url.change,"bucket"===n.props.type?{permission:n.state.default,bucket_id:n.props.id}:{permission:n.state.default,obj_id:n.props.id},n.globalState.request_headers).then((function(e){q.b.info("success"),n.props.onSuccess()})).catch((function(e){return q.b.warning(e.response.data.detail)}))},n.globalState=v.getState(),n.explain={private:"Only the owner of the bucket can access it",public_read_write:"Danger: Anybody can read and write data to this bucket!!!",public_read:"Anybody can read data from this bucket",authenticated:"Only the owner and authorized person can access it"},n.urls={bucket:{get:n.globalState.domain+"/api/buckets/query_perm?bucket_id=",change:n.globalState.domain+"/api/buckets/set_perm"},object:{get:n.globalState.domain+"/api/objects/query_perm?obj_id=",change:n.globalState.domain+"/api/objects/set_perm"}},"bucket"===n.props.type?n.url=n.urls.bucket:n.url=n.urls.object,n.state={default:null,explain:null},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.queryPermission(this.props.id)}},{key:"render",value:function(){return Object(le.jsxs)(s.a.Fragment,{children:[Object(le.jsxs)(X.a.Group,{value:this.state.default,buttonStyle:"solid",style:{marginTop:16},onChange:this.handlePermBtnClick,children:[Object(le.jsx)(X.a.Button,{value:"private",children:"Private"}),Object(le.jsx)(X.a.Button,{value:"public-read",children:"Public-read"}),Object(le.jsx)(X.a.Button,{value:"public-read-write",children:"Public-read-write"}),Object(le.jsx)(X.a.Button,{value:"authenticated",children:"Authenticated"})]}),Object(le.jsx)(H.a,{type:"info",message:"notice",style:{marginTop:5},description:this.state.explain})]})}}]),a}(s.a.Component),Ge=a(217),He=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).queryAuthorizedList=function(e){A.a.get(n.url.get+e,n.globalState.request_headers).then((function(e){n.setState({dataSource:e.data.data})}))},n.handleDeleteAuthorize=function(e){A.a.delete(n.url.delete+e.target.id,n.globalState.request_headers).then((function(e){q.b.info("success"),n.queryAuthorizedList(n.props.id)})).catch((function(e){q.b.warning(e.response.data.detail)}))},n.onSubmit=function(e){"object"===n.props.type?e.obj_id=parseInt(n.props.id):e.bucket_id=parseInt(n.props.id),A.a.post(n.url.add,e,n.globalState.request_headers).then((function(e){q.b.info("success"),n.queryAuthorizedList(n.props.id)})).catch((function(e){q.b.warning(e.response.data.detail)}))},n.columns=[{title:"User",dataIndex:"user__username"},{title:"bucket"===n.props.type?"Bucket":"Object",dataIndex:"bucket"===n.props.type?"bucket__name":"object__name"},{title:"Permission",dataIndex:"permission"},{title:"Operate",dataIndex:"acl_bid",render:function(e,t){return Object(le.jsx)("a",{href:"#",id:void 0!==t.acl_bid?t.acl_bid:t.acl_oid,onClick:n.handleDeleteAuthorize,children:"Remove"})}}],n.globalState=v.getState(),n.state={dataSource:[]},n.urls={object:{get:n.globalState.domain+"/api/objects/acl?obj_id=",delete:n.globalState.domain+"/api/objects/acl?acl_oid=",add:n.globalState.domain+"/api/objects/acl"},bucket:{get:n.globalState.domain+"/api/buckets/acl?bucket_id=",delete:n.globalState.domain+"/api/buckets/acl?acl_bid=",add:n.globalState.domain+"/api/buckets/acl"}},n.url=null,"bucket"===n.props.type&&(n.url=n.urls.bucket),"object"===n.props.type&&(n.url=n.urls.object),n.queryAuthorizedList(e.id),n}return Object(l.a)(a,[{key:"render",value:function(){return Object(le.jsxs)(s.a.Fragment,{children:[Object(le.jsx)("p",{children:"New authorize"}),Object(le.jsxs)(S.a,{layout:"inline",onFinish:this.onSubmit,initialValues:{permission:"authenticated-read"},children:[Object(le.jsx)(S.a.Item,{name:"username",rules:[{required:!0,message:"please input authorize username"}],children:Object(le.jsx)(C.a,{maxLength:64,style:{width:"200px"},prefix:Object(le.jsx)(u.a,{className:"site-form-item-icon"}),placeholder:"Username"})}),Object(le.jsx)(S.a.Item,{name:"permission",rules:[{required:!0,message:"please choice permission"}],children:Object(le.jsxs)(Ge.a,{style:{width:"100px"},children:[Object(le.jsx)(Ge.a.Option,{value:"authenticated-read",children:"read"}),Object(le.jsx)(Ge.a.Option,{value:"authenticated-read-write",children:"read-write"})]})}),Object(le.jsx)(S.a.Item,{children:Object(le.jsx)(B.a,{htmlType:"submit",type:"primary",children:"Submit"})})]}),Object(le.jsx)("p",{style:{margin:"30px 0 10px 0"},children:"Authorized list"}),Object(le.jsx)(G.a,{dataSource:this.state.dataSource,pagination:!1,columns:this.columns,rowKey:function(e){return void 0!==e.acl_bid?e.acl_bid:e.acl_oid}})]})}}]),a}(s.a.Component),Qe=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handlePermBtnClick=function(e){n.setState({permission_explain:n.explain[e.target.value.replaceAll("-","_")]})},n.submit=function(){n.formRef.submit()},n.onFinish=function(e){if(void 0===e.bucket_region_id||void 0===e.name)return q.b.error("no bucket name or not select region"),!1;A.a.post(n.globalState.domain+"/api/buckets/bucket",e,n.globalState.request_headers).then((function(){q.b.info("success"),n.props.onSuccess()})).catch((function(e){return q.b.warning(e.response.data.detail)}))},n.getRegionList=function(){A.a.get("".concat(n.globalState.domain,"/api/buckets/region"),n.globalState.request_headers).then((function(e){n.setState({region_list:e.data.data})}))},n.renderRegionOption=function(){return n.state.region_list.map((function(e){return Object(le.jsx)(Ge.a.Option,{value:e.reg_id,children:e.name},e.reg_id)}))},n.globalState=v.getState(),n.explain={private:"Only the owner of the bucket can access it",public_read_write:"Danger: Anybody can read and write data to this bucket!!!",public_read:"Anybody can read data from this bucket",authenticated:"Only the owner and authorized person can access it"},n.state={region_list:[],permission_explain:n.explain.private},n.formRef=s.a.createRef(),n.getRegionList(),n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(le.jsxs)(S.a,{layout:"vertical",ref:function(t){return e.formRef=t},onFinish:this.onFinish,children:[Object(le.jsx)(S.a.Item,{name:"name",rules:[{required:!0,message:"Please input your bucket name!",max:64}],label:"Name",children:Object(le.jsxs)($.b,{direction:"vertical",children:[Object(le.jsx)(C.a,{placeholder:"mybucket"}),Object(le.jsx)(H.a,{type:"info",message:"Notice",description:Object(le.jsxs)("div",{style:{fontSize:"12px"},children:[Object(le.jsx)("p",{style:{margin:"0"},children:"1-63 English characters, cannot start with a number."}),Object(le.jsx)("p",{style:{margin:"0"},children:"The name is globally unique and must not contain spaces and cannot be changed after creation."})]})})]})}),Object(le.jsx)(S.a.Item,{name:"bucket_region_id",label:"Region",rules:[{required:!0,message:"Please choice you region!"}],children:Object(le.jsx)(Ge.a,{placeholder:"region",children:this.renderRegionOption()})}),Object(le.jsx)(S.a.Item,{name:"permission",label:"Permission",initialValue:"private",rules:[{required:!0,message:"Please choice your permission!"}],children:Object(le.jsxs)($.b,{direction:"vertical",style:{width:"100%"},children:[Object(le.jsxs)(X.a.Group,{defaultValue:"private",buttonStyle:"solid",size:"small",onChange:this.handlePermBtnClick,style:{width:"100%",textAlign:"center"},children:[Object(le.jsx)(X.a.Button,{style:{width:"15%"},value:"private",children:"Private"}),Object(le.jsx)(X.a.Button,{style:{width:"25%"},value:"public-read",children:"Public-read"}),Object(le.jsx)(X.a.Button,{style:{width:"35%"},value:"public-read-write",children:"Public-read-write"}),Object(le.jsx)(X.a.Button,{style:{width:"25%"},value:"authenticated",children:"Authenticated"})]}),Object(le.jsx)(H.a,{type:"info",message:"Notice",description:Object(le.jsx)("div",{style:{fontSize:"12px"},children:Object(le.jsx)("p",{style:{margin:"0"},children:this.state.permission_explain})})})]})}),Object(le.jsx)(S.a.Item,{name:"version_control",initialValue:!1,label:"Versioning",style:{marginTop:-24},children:Object(le.jsxs)($.b,{direction:"vertical",style:{width:"100%"},children:[Object(le.jsxs)(X.a.Group,{defaultValue:!1,buttonStyle:"solid",size:"small",style:{width:"100%",textAlign:"center"},children:[Object(le.jsx)(X.a.Button,{style:{width:"50%"},value:!0,children:"Enable"}),Object(le.jsx)(X.a.Button,{style:{width:"50%"},value:!1,defaultChecked:!0,children:"Disable"})]}),Object(le.jsx)(H.a,{type:"info",message:"Notice",description:Object(le.jsx)("div",{style:{fontSize:"12px"},children:Object(le.jsx)("p",{style:{margin:"0"},children:"Versioning is a means of keeping multiple variants of an object in the same bucket. You can use versioning to preserve, retrieve, and restore every version of every object stored in your bucket. With versioning, you can easily recover from both unintended user actions and application failures."})})})]})})]})}}]),a}(s.a.Component),Ye={field:{display:"inline-block",width:100,textAlign:"right",marginRight:30}},Je=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).getBucketDetailInfo=function(){A.a.get(n.globalState.domain+"/api/buckets/detail?bucket_name="+n.props.bucket,n.globalState.request_headers).then((function(e){null!==e.data.data&&void 0!==e.data.data&&n.setState({data:e.data.data,usage:e.data.data.usage["rgw.main"]})})).catch((function(e){return q.b.error(e.response.data.detail)}))},n.globalState=v.getState(),n.state={data:{},usage:{}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getBucketDetailInfo()}},{key:"render",value:function(){return Object(le.jsxs)(Q.a,{style:{border:0},children:[Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:Ye.field,children:"Name"})," ",this.state.data.bucket]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:Ye.field,children:"Index type"}),this.state.data.index_type]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:Ye.field,children:"shards total"}),this.state.data.num_shards]}),void 0!==this.state.usage?Object(le.jsxs)("div",{children:[Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:Ye.field,children:"Objects total"}),this.state.usage.num_objects]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:Ye.field,children:"Actual used"}),re(this.state.usage.size_actual)]})]}):null,Object(le.jsx)(H.a,{showIcon:!0,type:"info",message:"Information",description:"The above information comes from the back-end storage server"})]})}}]),a}(s.a.Component),We=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).submit=function(){if(n.state.inputValue!==n.props.name)return q.b.error("bucket name is incorrect!");A.a.delete(n.globalState.domain+"/api/buckets/bucket",{data:{bucket_id:n.props.id},headers:n.globalState.request_headers.headers}).then((function(){q.b.info("success"),n.props.onSuccess()})).catch((function(e){return q.b.warning(e.response.data.detail)}))},n.onChange=function(e){n.setState({inputValue:e.target.value})},n.globalState=v.getState(),n.state={inputValue:""},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(le.jsxs)($.b,{direction:"vertical",children:[Object(le.jsx)(H.a,{showIcon:!0,type:"error",message:"Warning",description:"Deleting the bucket will delete all the files in the bucket, and the files cannot be recovered after being deleted"}),Object(le.jsx)("label",{children:"Bucket Name"}),Object(le.jsx)(C.a,{placeholder:this.props.name,onChange:this.onChange})]})}}]),a}(s.a.Component),Ze=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).submit=function(){A.a.put(n.globalState.domain+"/api/buckets/bucket",{bucket_id:n.props.id,bucket_region_id:n.state.bucket_region_id},n.globalState.request_headers).then((function(){q.b.info("success"),n.props.onSuccess()})).catch((function(e){return q.b.warning(e.response.data.detail)}))},n.getRegionList=function(){A.a.get("".concat(n.globalState.domain,"/api/buckets/region"),n.globalState.request_headers).then((function(e){n.setState({region_list:e.data.data})})).catch((function(e){console.log(e.response)}))},n.renderRegionOption=function(){return n.state.region_list.map((function(e){return Object(le.jsx)(Ge.a.Option,{value:e.reg_id,children:e.name},e.reg_id)}))},n.handleRegionChange=function(e){n.setState({bucket_region_id:e})},n.globalState=v.getState(),n.state={bucket_region_id:null,region_list:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getRegionList()}},{key:"render",value:function(){return Object(le.jsxs)(s.a.Fragment,{children:[Object(le.jsx)(H.a,{showIcon:!0,type:"info",message:"Notice",description:Object(le.jsxs)("div",{children:[Object(le.jsx)("p",{children:"1. The backup operation will automatically create a new bucket, creating a backup will cost more storage space "}),Object(le.jsx)("p",{children:"2. The new bucket just be read-only, upload or delete files to the original bucket, the backup bucket will automatically synchronize the operation,"})]})}),Object(le.jsx)("p",{style:{marginTop:"20px",marginBottom:"10px"},children:"Backup Destination Region"}),Object(le.jsx)(Ge.a,{placeholder:"region",style:{width:"100%"},onSelect:this.handleRegionChange,children:this.renderRegionOption()})]})}}]),a}(s.a.Component),Xe=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).submit=function(){if(0===n.state.folder_name.trim().length)return q.b.warning("please input folder name"),!1;A.a.post(n.globalState.domain+"/api/objects/create_folder",0===n.props.path.length?{bucket_name:n.props.name,folder_name:n.state.folder_name}:{bucket_name:n.props.name,folder_name:n.state.folder_name,path:n.props.path},n.globalState.request_headers).then((function(){q.b.info("success"),n.setState({folder_name:""}),n.props.onSuccess()})).catch((function(e){return q.b.warning(e.response.data.detail)}))},n.globalState=v.getState(),n.state={folder_name:""},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(le.jsx)(C.a,{placeholder:"please input folder name",onChange:function(t){e.setState({folder_name:t.target.value})}})}}]),a}(s.a.Component),$e=a(570),et=a(589),tt=$e.a.Dragger,at=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onChange=function(e){var t=e.file.status;"done"===t?(q.b.success("".concat(e.file.name," file uploaded successfully.")),n.props.onSuccess()):"error"===t&&q.b.error(e.file.response.detail)},n.submit=function(e){console.log(e)},n.handlePermissionChange=function(e){e.target.value&&n.setState({permission:"inherit"===e.target.value?"":e.target.value,permission_explain:n.explain[e.target.value.replaceAll("-","_")]})},n.globalState=v.getState(),n.explain={private:"Only the owner of the bucket can access it",public_read_write:"Danger: Anybody can read and write data to this bucket!!!",public_read:"Anybody can read data from this bucket",authenticated:"Only the owner and authorized person can access it",inherit:"Inherit the permissions of the bucket"},n.state={upload_url:n.globalState.domain+"/api/objects/upload_file",permission:"",permission_explain:n.explain.inherit},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(le.jsxs)($.b,{direction:"vertical",children:[Object(le.jsxs)(tt,{multiple:!0,name:"file",action:this.state.upload_url,method:"PUT",onChange:this.onChange,headers:this.globalState.request_headers.headers,showUploadList:{showPreviewIcon:!1,showRemoveIcon:!1,showDownloadIcon:!0,removeIcon:!1,downloadIcon:!0},data:function(){return{bucket_name:e.props.name,path:e.props.path,permission:e.state.permission}},children:[Object(le.jsx)("p",{style:{fontSize:"12px"},className:"ant-upload-drag-icon",children:Object(le.jsx)(et.a,{})}),Object(le.jsx)("p",{style:{fontSize:"12px"},className:"ant-upload-text",children:"Click or drag file to this area to upload"}),Object(le.jsx)("p",{style:{fontSize:"12px"},className:"ant-upload-hint",children:"Support for a single or bulk upload."})]}),Object(le.jsxs)(X.a.Group,{defaultValue:"inherit",buttonStyle:"solid",size:"small",style:{width:"100%",textAlign:"center"},onChange:this.handlePermissionChange,children:[Object(le.jsx)(X.a.Button,{value:"inherit",children:"Inherit"}),Object(le.jsx)(X.a.Button,{value:"private",children:"Private"}),Object(le.jsx)(X.a.Button,{value:"public-read",children:"Public-read"}),Object(le.jsx)(X.a.Button,{value:"public-read-write",children:"Public-read-write"}),Object(le.jsx)(X.a.Button,{value:"authenticated",children:"Authenticated"})]}),Object(le.jsx)(H.a,{type:"info",message:"Notice",description:Object(le.jsx)("div",{style:{fontSize:"12px"},children:Object(le.jsx)("p",{style:{margin:"0"},children:this.state.permission_explain})})})]})}}]),a}(s.a.Component),nt=Se.a.Content,st=function(e){var t=JSON.parse(window.sessionStorage.getItem("user_info")).data.user_id;return Object(le.jsxs)(E.a,{onClick:function(t){return e.openDrawer(t,e)},children:[Object(le.jsx)(E.a.Item,{disabled:t!==e.user.id,children:"Authorize"},"BucketAuthorize"),Object(le.jsx)(E.a.Item,{disabled:t!==e.user.id,children:"Backup"},"BucketBackup"),Object(le.jsx)(E.a.Item,{children:"Detail"},"BucketDetail"),Object(le.jsx)(E.a.Item,{disabled:t!==e.user.id,children:"Permission"},"BucketPermission"),Object(le.jsx)(E.a.Divider,{}),Object(le.jsx)(E.a.Item,{disabled:t!==e.user.id,danger:!0,children:"Delete"},"BucketDelete")]})},it=function(e){return Object(le.jsxs)(E.a,{onClick:function(t){return e.openDrawer(t,e)},children:[Object(le.jsx)(E.a.Item,{disabled:"d"===e.type,children:"Authorize"},"ObjectAuthorize"),Object(le.jsx)(E.a.Item,{disabled:"d"===e.type,children:"Permission"},"ObjectPermission"),Object(le.jsx)(E.a.Divider,{}),Object(le.jsx)(E.a.Item,{danger:!0,children:"Delete"},"ObjectDelete")]})},rt=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).objectTableColumns=[{title:"Name",dataIndex:"name",render:function(e,t){return"d"===t.type?Object(le.jsxs)("a",{href:"#",onClick:function(){return n.getObjectsOfBucket(n.state.bucket_name,t.key_url)},children:[Object(le.jsx)(Le.a,{style:{marginRight:5}}),e]}):Object(le.jsxs)("a",{href:"#",onClick:function(){return n.download_file(t)},children:[Object(le.jsx)(Me.a,{style:{marginRight:5}}),e]})}},{title:"Filesize",dataIndex:"file_size",render:function(e){return re(e,2)}},{title:"Permission",dataIndex:"permission"},{title:"Upload Time",dataIndex:"upload_time",render:function(e){return e.substr(0,16)}},{title:"Action",key:"obj_id",render:function(e){return e.openDrawer=n.openDrawer,Object(le.jsx)($.b,{size:"middle",children:Object(le.jsx)(K.a,{overlay:it.bind(Object(T.a)(n),e),trigger:["click"],children:Object(le.jsxs)("a",{className:"ant-dropdown-link",onClick:function(e){return e.preventDefault()},children:["more",Object(le.jsx)(Y.a,{})]})})})}}],n.bucketTableColumns=[{title:"Name",dataIndex:"name",render:function(e,t){return t.user.id===n.globalState.user_info.data.user_id?Object(le.jsx)("a",{href:"#",onClick:function(){return n.getObjectsOfBucket(e)},children:e}):e}},{title:"Owner",dataIndex:"user",render:function(e){return e.first_name}},{title:"Permission",dataIndex:"en_permission"},{title:"Region",dataIndex:"bucket_region",render:function(e){return e.name}},{title:"Version Control",dataIndex:"version_control",render:function(e){return e?"Enabled":"Disabled"}},{title:"Create time",dataIndex:"create_time",render:function(e){return e.substr(0,10)}},{title:"Action",key:"bucket_id",render:function(e){return e.openDrawer=n.openDrawer,Object(le.jsx)($.b,{size:"middle",children:Object(le.jsx)(K.a,{overlay:st.bind(Object(T.a)(n),e),trigger:["click"],children:Object(le.jsxs)("a",{className:"ant-dropdown-link",onClick:function(e){return e.preventDefault()},children:["more",Object(le.jsx)(Y.a,{})]})})})}}],n.getObjectsOfBucket=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.state.bucket_name,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.state.current_path,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==e&&A.a.get(n.globalState.domain+"/api/objects/list_objects",{params:{bucket_name:e,page:a,path:t},headers:n.globalState.request_headers.headers}).then((function(t){n.setState({bucket_name:e,content_type:"file",data:t.data.data,previous_path:t.data.page_info.previous_path,current_path:t.data.page_info.current_path,page_info:t.data.page_info})})).catch((function(e){e.response&&403===e.response.data.status&&(window.sessionStorage.setItem("user_info",null),window.location.reload())}))},n.getBucketList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;A.a.get("".concat(n.globalState.domain,"/api/buckets/bucket"),{params:{size:10,page:e},headers:n.globalState.request_headers.headers}).then((function(e){n.setState({data:e.data.data,content_type:"bucket",page_info:e.data.page_info})})).catch((function(e){e.response&&403===e.response.data.status&&(window.sessionStorage.setItem("user_info",null),window.location.reload())}))},n.handleBackClick=function(e){n.getObjectsOfBucket(n.state.bucket_name,n.state.previous_path,n.state.page_info.current_page)},n.handlePageChange=function(e){"bucket"===n.state.content_type?n.getBucketList(e):n.getObjectsOfBucket(n.state.bucket_name,n.state.current_path,e)},n.deleteObject=function(e){A.a.delete(n.globalState.domain+"/api/objects/delete",{params:{bucket_name:n.state.bucket_name,key:e},headers:n.globalState.request_headers.headers}).then((function(){q.b.info("success"),n.getObjectsOfBucket(n.state.bucket_name,n.state.current_path,n.state.page_info.current_page)})).catch((function(e){return q.b.error(e.response.data.detail)}))},n.openDrawer=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=null,s=!1;switch(e.key){case"BucketPermission":a=Object(le.jsx)(Ke,{onSuccess:n.subComponentSuccess,ref:function(e){return n.Child=e},id:t.bucket_id,type:"bucket"}),s=n.drawerFoot();break;case"BucketAuthorize":a=Object(le.jsx)(He,{ref:function(e){return n.Child=e},id:t.bucket_id,type:"bucket"});break;case"ObjectPermission":a=Object(le.jsx)(Ke,{onSuccess:n.subComponentSuccess,ref:function(e){return n.Child=e},id:t.obj_id,type:"object"}),s=n.drawerFoot();break;case"ObjectAuthorize":a=Object(le.jsx)(He,{onSuccess:n.subComponentSuccess,ref:function(e){return n.Child=e},id:t.obj_id,type:"object"});break;case"BucketDetail":a=Object(le.jsx)(Je,{bucket:t.name});break;case"BucketDelete":a=Object(le.jsx)(We,{onSuccess:n.subComponentSuccess,ref:function(e){return n.Child=e},id:t.bucket_id,name:t.name}),s=n.drawerFoot();break;case"BucketBackup":a=Object(le.jsx)(Ze,{onSuccess:n.subComponentSuccess,ref:function(e){return n.Child=e},id:t.bucket_id}),s=n.drawerFoot();break;case"ObjectDelete":k.a.confirm({icon:Object(le.jsx)(J.a,{}),title:"warning",okType:"danger",content:"Deleting file object confirm, can not resume!!!",onOk:function(){n.deleteObject(t.key_url)}});break;case"Create Bucket":a=Object(le.jsx)(Qe,{onSuccess:n.subComponentSuccess,ref:function(e){return n.Child=e}}),s=n.drawerFoot();break;case"Upload":a=Object(le.jsx)(at,{onSuccess:n.getObjectsOfBucket,ref:function(e){return n.Child=e},name:n.state.bucket_name,path:n.state.current_path}),s=null;break;case"New folder":a=Object(le.jsx)(Xe,{onSuccess:n.subComponentSuccess,ref:function(e){return n.Child=e},name:n.state.bucket_name,path:n.state.current_path}),s=n.drawerFoot()}null!==a&&n.setState({drawer_state:!0,drawer_title:e.key,drawer_content:a,drawer_foot:s,dropdown_menu_state:!1})},n.closeDrawer=function(){n.setState({drawer_state:!1,drawer_content:null})},n.subComponentSuccess=function(){n.closeDrawer(),"bucket"===n.state.content_type?n.getBucketList():n.getObjectsOfBucket(n.state.bucket_name,n.state.current_path,n.state.page_info.current_page)},n.onSubmit=function(){n.Child.submit()},n.drawerFoot=function(){return Object(le.jsx)("div",{style:{textAlign:"right"},children:Object(le.jsx)(B.a,{onClick:n.onSubmit,type:"primary",children:"Submit"})})},n.download_file=function(e){A.a.post(n.globalState.domain+"/api/objects/generate_download_url",{bucket_name:e.bucket.name,key:e.key_url},n.globalState.request_headers).then((function(e){window.open(e.data.url,"_blank")})).catch((function(e){return q.b.error(e.response.data.detail)}))},n.globalState=v.getState(),n.Child=s.a.createRef(),n.state={drawer_state:!1,data:[],drawer_content:null,drawer_foot:null,content_type:"bucket",bucket_name:null,previous_path:"",current_path:"",page_info:{}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getBucketList()}},{key:"render",value:function(){var e=this;return Object(le.jsx)(s.a.Fragment,{children:Object(le.jsxs)(nt,{style:{padding:"0 50px"},children:[Object(le.jsxs)(Re.a,{style:{margin:"16px 0"},children:[Object(le.jsx)(Re.a.Item,{children:"Home"}),Object(le.jsx)(Re.a.Item,{children:"Bucket"}),Object(le.jsx)(Re.a.Item,{children:"List"})]}),Object(le.jsxs)(Se.a,{className:"site-layout-background",style:{padding:"24px 0"},children:[Object(le.jsxs)(nt,{children:[Object(le.jsxs)(B.a,{type:"primary",style:{margin:"10px 0",width:"146px"},onClick:function(){var t="bucket"===e.state.content_type?"Create Bucket":"Upload";e.openDrawer({key:t},null)},children:["bucket"===this.state.content_type?Object(le.jsx)(Ue.a,{}):Object(le.jsx)(Te.a,{}),"bucket"===this.state.content_type?"Create Bucket":"Upload"]}),Object(le.jsx)("p",{children:"bucket"!==this.state.content_type?Object(le.jsxs)(s.a.Fragment,{children:[0===this.state.current_path.length?Object(le.jsxs)(B.a,{type:"link",onClick:function(){return e.getBucketList(1)},style:{color:"#666"},children:[Object(le.jsx)(Ee.a,{})," Back"]}):Object(le.jsxs)(B.a,{type:"link",onClick:this.handleBackClick,children:[Object(le.jsx)(Ee.a,{})," Back"]}),Object(le.jsxs)(B.a,{type:"link",onClick:function(){return e.openDrawer({key:"New folder"},null)},children:[Object(le.jsx)(Ve.a,{})," New folder"]})]}):Object(le.jsx)("br",{})}),Object(le.jsx)(G.a,{columns:"bucket"===this.state.content_type?this.bucketTableColumns:this.objectTableColumns,dataSource:this.state.data,pagination:{current:this.state.page_info.current_page,pageSize:this.state.page_info.page_size,total:this.state.page_info.record_count,onChange:this.handlePageChange},style:{marginTop:-9},rowKey:function(t){return"bucket"===e.state.content_type?t.bucket_id:t.obj_id}})]}),Object(le.jsx)(D.a,{width:"500px",title:this.state.drawer_title,placement:"right",closable:!0,onClose:this.closeDrawer,visible:this.state.drawer_state,footer:this.state.drawer_foot,children:this.state.drawer_content})]})]})})}}]),a}(n.Component),ct=a(592),lt=a(593),ot=a(594),dt=C.a.Search,ut=function(e){var t={field:{width:"100px",display:"inline-block",textAlign:"right",marginRight:"20px"}};return Object(le.jsxs)("div",{children:[Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:t.field,children:"orderNo."}),e.data.no]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:t.field,children:"product"}),e.data.en_product]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:t.field,children:"detail"}),e.data.detail]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:t.field,children:"create date"}),e.data.create_date.substr(0,19)]}),Object(le.jsx)(ae.a,{}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:t.field,children:"plan"}),e.data.plan.name]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:t.field,children:"play"}),e.data.pay]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:t.field,children:"real play"}),e.data.real_pay]})]})},bt=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).getUserOrders=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=n.globalState.domain+"/api/account/order?page="+e;t.trim().length>1&&(a+="&order_no="+t),A.a.get(a,{headers:n.globalState.request_headers.headers}).then((function(e){n.setState({data_list:e.data.data,page_info:e.data.page_info})})).catch((function(e){e.response&&403===e.response.status&&window.sessionStorage.setItem("user_info",null)}))},n.handlePageChange=function(e){n.getUserOrders(e)},n.handleOrderDetail=function(e){n.setState({visible:!0,drawer_content:Object(le.jsx)(ut,{data:e})})},n.orderColumns=[{title:"OrderNo.",dataIndex:"no"},{title:"Product",dataIndex:"en_product"},{title:"Ceate time",dataIndex:"create_date",render:function(e){return e.substr(0,16)}},{title:"Detail",dataIndex:"id",render:function(e,t){return Object(le.jsx)(B.a,{style:{margin:0,padding:0},type:"link",onClick:function(e){n.handleOrderDetail(t)},children:"Detail"})}}],n.onSearch=function(e){n.getUserOrders(1,e)},n.globalState=v.getState(),n.state={data_list:[],visible:!1,order_detail:{},page_info:{},drawer_content:null},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getUserOrders()}},{key:"render",value:function(){var e=this;return Object(le.jsxs)(Q.a,{title:"Order List",children:[Object(le.jsxs)(I.a,{gutter:[8,8],children:[Object(le.jsx)(R.a,{span:8,children:Object(le.jsx)(dt,{placeholder:"input order No.",onSearch:this.onSearch,enterButton:!0})}),Object(le.jsx)(R.a,{span:24,children:Object(le.jsx)(G.a,{columns:this.orderColumns,dataSource:this.state.data_list,rowKey:function(e){return e.id},pagination:{current:this.state.page_info.current_page,pageSize:this.state.page_info.page_size,total:this.state.page_info.record_count,onChange:this.handlePageChange}})})]}),Object(le.jsx)(D.a,{title:"Order Detail",width:"400px",visible:this.state.visible,placement:"right",closable:!0,onClose:function(){e.setState({visible:!1,drawer_content:null})},children:this.state.drawer_content})]})}}]),a}(n.Component),ht=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).getLocalTime=function(e){return new Date(1e3*parseInt(e)).toLocaleString("en-Us")},n.getLicenseInfo=function(){A.a.get(n.globalState.domain+"/api/license",{headers:n.globalState.request_headers.headers}).then((function(e){return n.setState({data:e.data.license})}))},n.globalState=v.getState(),n.state={data:[],drawer_content:""},n.styles={itemField:{width:"100px",display:"inline-block",textAlign:"right",marginRight:"20px"}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getLicenseInfo()}},{key:"render",value:function(){return Object(le.jsxs)(Q.a,{title:"License info",children:[Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.styles.itemField,children:"Information"}),this.state.data.info]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.styles.itemField,children:"Max Users"}),this.state.data.max_users]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.styles.itemField,children:"Max Buckets"}),this.state.data.max_bucket]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.styles.itemField,children:"Max Capacity"}),this.state.data.max_capacity," G"]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.styles.itemField,children:"Start Time"}),this.getLocalTime(this.state.data.start_time)]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.styles.itemField,children:"End Time"}),this.getLocalTime(this.state.data.end_time)]}),Object(le.jsxs)("p",{children:[Object(le.jsx)("b",{style:this.styles.itemField,children:"Status"}),this.state.data.expire?"Expired":"Normal"]})]})}}]),a}(n.Component),jt=Se.a.Content,pt=Se.a.Sider,mt=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleLeftMenuClick=function(e){e.key in n.contents&&n.setState({content:n.contents[e.key]})},n.globalstate=v.getState(),n.contents={aboutMe:Object(le.jsx)(me,{}),subusers:Object(le.jsx)(_e,{}),orderList:Object(le.jsx)(bt,{}),license:Object(le.jsx)(ht,{})},n.state={content:Object(le.jsx)(me,{})},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(le.jsxs)(jt,{style:{padding:"0 50px"},children:[Object(le.jsxs)(Re.a,{style:{margin:"16px 0"},children:[Object(le.jsx)(Re.a.Item,{children:"Home"}),Object(le.jsx)(Re.a.Item,{children:"Mine"})]}),Object(le.jsxs)(Se.a,{className:"site-layout-background",style:{padding:"24px 0"},children:[Object(le.jsx)(pt,{className:"site-layout-background",width:200,children:Object(le.jsxs)(E.a,{mode:"inline",defaultSelectedKeys:["aboutMe"],style:{height:"100%"},onClick:this.handleLeftMenuClick,children:[Object(le.jsx)(E.a.Item,{icon:Object(le.jsx)(ct.a,{}),children:"About Me"},"aboutMe"),Object(le.jsx)(E.a.Item,{icon:Object(le.jsx)(u.a,{}),children:"Sub Users"},"subusers"),Object(le.jsx)(E.a.Item,{icon:Object(le.jsx)(lt.a,{}),children:"Order"},"orderList"),Object(le.jsx)(E.a.Item,{icon:Object(le.jsx)(ot.a,{}),children:"License"},"license")]})}),Object(le.jsx)(jt,{style:{marginLeft:8,minHeight:280},children:this.state.content})]})]})}}]),a}(n.Component),ft=a(596),gt=a(597),Ot=a(598),xt=a(599),yt=a(573),_t=a(584),wt=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).submit=function(){n.formRef.submit()},n.formRef=s.a.createRef(),n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(le.jsx)(S.a,{layout:"vertical",ref:function(t){return e.formRef=t},onFinish:this.props.onFinish,children:Object(le.jsx)(S.a.Item,{name:"name",label:"name",rules:[{required:!0,message:"please input role name",max:20}],children:Object(le.jsx)(C.a,{placeholder:"role name"})})})}}]),a}(n.Component),vt=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).getAllPerms=function(){A.a.get(n.globalState.domain+"/api/user/perm/all_perms",{headers:n.globalState.request_headers.headers}).then((function(e){n.setState({data:e.data.data})})).catch((function(e){e.response&&403===e.response.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.warning(e.response.data.detail)}))},n.submit=function(){void 0!==n.props.roleName?A.a.post(n.globalState.domain+"/api/user/group/perm",{role:n.props.roleName,perms:n.targetKeys},n.globalState.request_headers).then((function(e){return q.b.success("success")})).catch((function(e){e.response&&403===e.response.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.error(e.response.data.detail)})):q.b.warning("role name is empty")},n.onCheck=function(e){var t=[];e.map((function(e){return-1===e.indexOf("-")&&t.push(e),!1})),n.targetKeys=t},n.globalState=v.getState(),n.targetKeys=[],n.state={data:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getAllPerms()}},{key:"render",value:function(){return 0===this.state.data.length?"loading tree":Object(le.jsx)(yt.a,{checkable:!0,defaultCheckedKeys:this.props.hasPermissions.map((function(e){return e.key})),onCheck:this.onCheck,treeData:this.state.data})}}]),a}(n.Component),kt=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).setDefaultRole=function(e){A.a.put(n.globalState.domain+"/api/user/role/default",{group_id:e},{headers:n.globalState.request_headers.headers}).then((function(){q.b.success("success"),n.getAllRoles()})).catch((function(e){e.response&&403===e.response.data.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.warning(e.response.data.detail)}))},n.removeRole=function(e){A.a.delete(n.globalState.domain+"/api/user/group/role",{params:{id:e},headers:n.globalState.request_headers.headers}).then((function(){q.b.success("success"),n.getAllRoles()})).catch((function(e){e.response&&403===e.response.data.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.warning(e.response.data.detail)}))},n.removePermission=function(e,t){A.a.delete(n.globalState.domain+"/api/user/group/perm",{data:{role:t,perms:[e]},headers:n.globalState.request_headers.headers}).then((function(){return q.b.success("success")})).catch((function(e){e.response&&403===e.response.data.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.warning(e.response.data.detail)}))},n.UsersInRole=function(e,t){return e.map((function(e,a){return Object(le.jsx)(_t.a,{style:{marginBottom:10},closable:!0,onClose:function(){return n.removePermission(e.key,t)},children:e.label},"tag_index_"+a)}))},n.getAllRoles=function(){A.a.get(n.globalState.domain+"/api/user/group/role",{headers:n.globalState.request_headers.headers}).then((function(e){return n.setState({data:e.data.data})}))},n.handleAddRole=function(e){A.a.post(n.globalState.domain+"/api/user/group/role",e,n.globalState.request_headers).then((function(){q.b.success("success"),n.subComponentSuccess()})).catch((function(e){e.response&&403===e.response.data.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.warning(e.response.data.detail)}))},n.handleBtnClick=function(e,t){switch(e){case"add permission":n.setState({drawer_title:"add permission to role",drawer_content:Object(le.jsx)(vt,{hasPermissions:t.permissions,roleName:t.name,ref:function(e){return n.Child=e}}),visible:!0});break;case"set default role":n.setDefaultRole(t.id);break;case"delete":k.a.confirm({icon:Object(le.jsx)(J.a,{}),title:"warning",okType:"danger",content:"Deleting role\uff0call associated users will lose their permissions",onOk:function(){n.removeRole(t.id)}});break;case"New Role":n.setState({drawer_title:"new role",drawer_content:Object(le.jsx)(wt,{ref:function(e){return n.Child=e},onFinish:n.handleAddRole}),visible:!0})}},n.drawerClose=function(e){n.setState({drawer_title:null,drawer_content:null,visible:!1})},n.subComponentSuccess=function(){n.setState({drawer_title:null,drawer_content:null,visible:!1}),n.getAllRoles()},n.onSubmit=function(){n.Child.submit()},n.regionColumns=[{title:"name",dataIndex:"name"},{title:"default",dataIndex:"default",width:150,render:function(e){return e?"Yes":"No"}},{title:"action",dataIndex:"id",width:200,render:function(e,t){return Object(le.jsxs)("div",{children:[Object(le.jsx)(B.a,{type:"link",onClick:function(){return n.handleBtnClick("add permission",t)},children:"add permission"}),Object(le.jsx)(B.a,{type:"link",onClick:function(){return n.handleBtnClick("set default role",t)},children:"set default role"}),Object(le.jsx)(B.a,{type:"link",onClick:function(){return n.handleBtnClick("delete",t)},children:"delete"})]})}}],n.globalState=v.getState(),n.Child=s.a.createRef(),n.state={data:[],drawer_title:"",visisble:!1,drawer_content:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getAllRoles()}},{key:"render",value:function(){var e=this;return Object(le.jsxs)(Q.a,{title:"Role List",children:[Object(le.jsxs)(B.a,{onClick:function(){return e.handleBtnClick("New Role",null)},type:"primary",style:{marginBottom:10},children:[Object(le.jsx)(Ue.a,{}),"New Role"]}),Object(le.jsx)(G.a,{dataSource:this.state.data,columns:this.regionColumns,rowKey:function(e){return e.id},expandable:{expandedRowRender:function(t){return Object(le.jsxs)("div",{children:[Object(le.jsx)("b",{style:{paddingRight:10},children:"permissions"}),e.UsersInRole(t.permissions,t.name),Object(le.jsx)("br",{}),Object(le.jsx)("b",{children:"users"})]})}}}),Object(le.jsx)(D.a,{title:this.state.drawer_title,width:500,onClose:this.drawerClose,visible:this.state.visible,closable:!0,footer:Object(le.jsx)("div",{style:{textAlign:"right"},children:Object(le.jsx)(B.a,{onClick:this.onSubmit,type:"primary",children:"Submit"})}),children:this.state.drawer_content})]})}}]),a}(n.Component),St=a(579),Ct=a(595),It=a(434),Rt=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).submit=function(){s.formRef.submit()},s.formRef=Object(n.createRef)(),void 0===s.props.formData?s.formId=0:s.formId=s.props.formData.id,s}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(le.jsxs)(S.a,{layout:"vertical",onFinish:function(t){return e.props.onFinish(t,e.formId)},ref:function(t){return e.formRef=t},initialValues:this.props.formData,children:[Object(le.jsx)(S.a.Item,{name:"s_price",label:"Storage Price (per day)",rules:[{required:!0,message:"please input storage price"}],children:Object(le.jsx)(ee.a,{min:"0",max:"10",step:"0.01",onChange:function(t){return e.formRef.setFieldsValue({s_price:parseFloat(t)})},stringMode:!0})}),Object(le.jsx)(S.a.Item,{name:"b_price",label:"Bandwidth Price (per day)",rules:[{required:!0,message:"please input bandwidth price"}],children:Object(le.jsx)(ee.a,{min:"0",max:"10",step:"0.01",onChange:function(t){return e.formRef.setFieldsValue({b_price:parseFloat(t)})},stringMode:!0})}),Object(le.jsx)(S.a.Item,{name:"plan_min_days",label:"Plan min require days (day)",rules:[{required:!0,message:"please input plan min require days"}],children:Object(le.jsx)(ee.a,{min:"1",max:"9999",step:"30",parser:function(e){return parseInt(e)},onChange:function(t){return e.formRef.setFieldsValue({plan_min_days:parseInt(t)})},stringMode:!0})}),Object(le.jsx)(S.a.Item,{name:"offset",label:"Offset",rules:[{required:!0,message:"please input storage price"}],children:Object(le.jsx)(ee.a,{min:0,max:1,step:.01,formatter:function(e){return ie(e)},parser:function(e){return parseInt(e.replace("%",""))/100},onChange:function(t){return e.formRef.setFieldsValue({offset:parseFloat(t)})},stringMode:!0})}),Object(le.jsx)(S.a.Item,{name:"offset_min_days",label:"Offset min require days (day)",rules:[{required:!0,message:"please input storage price"}],children:Object(le.jsx)(ee.a,{min:"1",max:"9999",step:"30",onChange:function(t){return e.formRef.setFieldsValue({offset_min_days:parseInt(t)})},stringMode:!0})}),Object(le.jsx)(S.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"please input plan name!",max:50}],children:Object(le.jsx)(C.a,{placehold:"plan name"})}),Object(le.jsx)(S.a.Item,{name:"state",label:"State",rules:[{required:!0,message:"please choice region state!",max:1}],children:Object(le.jsxs)(X.a.Group,{buttonStyle:"solid",style:{width:"100%",textAlign:"center"},children:[Object(le.jsx)(X.a.Button,{value:"e",style:{width:"50%"},children:"Enable"}),Object(le.jsx)(X.a.Button,{value:"d",style:{width:"50%"},children:"Disable"})]})})]})}}]),a}(n.Component),Bt=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).getPlanList=function(){A.a.get(n.globalState.domain+"/api/account/plan",{headers:n.globalState.request_headers.headers}).then((function(e){return n.setState({data:e.data.data})})).catch((function(e){e.response&&403===e.response.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.error(e.response.data.detail)}))},n.planColumns=[{title:"Name",dataIndex:"name"},{title:"Storage Price",dataIndex:"s_price"},{title:"Bandwidth Price",dataIndex:"b_price"},{title:"Plan Min Days",dataIndex:"plan_min_days"},{title:"Offset",dataIndex:"offset",render:function(e){return ie(e)}},{title:"Offset Min Days",dataIndex:"offset_min_days"},{title:"Status",dataIndex:"state",render:function(e){return"e"===e?Object(le.jsx)(St.a,{status:"processing",text:"Enable"}):Object(le.jsx)(St.a,{status:"error",text:"Disable"})}},{title:"Action",dataIndex:"id",render:function(e,t){return Object(le.jsxs)($.b,{children:[Object(le.jsx)(B.a,{icon:Object(le.jsx)(Ct.a,{}),onClick:function(e){return n.handleBtnClick("editPlan",t)},children:"Edit"}),Object(le.jsx)(B.a,{icon:Object(le.jsx)(It.a,{}),onClick:function(e){return n.handleBtnClick("deletePlan",t)},children:"Delete"})]})}}],n.drawerClose=function(e){n.setState({drawer_title:null,drawer_content:null,visible:!1}),n.getPlanList()},n.formFinish=function(e,t){var a=n.globalState.domain+"/api/account/plan",s=null;0===t&&(s=A.a.post(a,e,n.globalState.request_headers)),t>0&&(e.id=t,s=A.a.put(a,e,n.globalState.request_headers)),null!=s&&s.then((function(e){return q.b.success("success")})).catch((function(e){e.response&&403===e.response.data.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.warning(e.response.data.detail)}))},n.deletePlan=function(e){A.a.delete(n.globalState.domain+"/api/account/plan?id="+e,{headers:n.globalState.request_headers.headers}).then((function(e){q.b.success("success"),n.getPlanList()})).catch((function(e){e.response&&403===e.response.data.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.warning(e.response.data.detail)}))},n.onSubmit=function(){n.Child.submit()},n.handleBtnClick=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;switch(e){case"newPlan":n.setState({drawer_content:Object(le.jsx)(Rt,{ref:function(e){return n.Child=e},onFinish:n.formFinish}),drawer_title:"New Plan",visible:!0});break;case"editPlan":n.setState({drawer_content:Object(le.jsx)(Rt,{ref:function(e){return n.Child=e},formData:t,onFinish:n.formFinish}),drawer_title:"Edit Plan",visible:!0});break;case"deletePlan":k.a.confirm({icon:Object(le.jsx)(J.a,{}),title:"warning",content:"Deleting plan will be destroy all related order",okType:"danger",onOk:function(){n.deletePlan(t.id)}})}},n.globalState=v.getState(),n.Child=s.a.createRef(),n.state={data:[],drawer_title:"",visible:!1,drawer_content:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getPlanList()}},{key:"render",value:function(){var e=this;return Object(le.jsxs)(Q.a,{title:"Plan & Price List",children:[Object(le.jsxs)(B.a,{type:"primary",style:{marginBottom:10},onClick:function(t){return e.handleBtnClick("newPlan")},children:[Object(le.jsx)(Ue.a,{}),"New Plan"]}),Object(le.jsx)(G.a,{dataSource:this.state.data,columns:this.planColumns,rowKey:function(e){return e.id}}),Object(le.jsx)(D.a,{title:this.state.drawer_title,width:400,onClose:this.drawerClose,visible:this.state.visible,closable:!0,footer:Object(le.jsx)("div",{style:{textAlign:"right"},children:Object(le.jsx)(B.a,{onClick:this.onSubmit,type:"primary",children:"Submit"})}),children:this.state.drawer_content})]})}}]),a}(n.Component),qt=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).submit=function(){s.formRef.submit()},s.regionTypeChange=function(e){"amazon"===e&&s.setState({endpoint_text:s.type_explain.amazon}),"local"===e&&s.setState({endpoint_text:s.type_explain.local})},s.formRef=Object(n.createRef)(),s.type_explain={amazon:"https://s3.region-code.amazonaws.com",local:"ceph rgw gateway address"},s.state={endpoint_text:s.props.formData?s.type_explain[s.props.formData.type]:s.type_explain.local},void 0!==s.props.formData&&s.props.formData.reg_id>0?s.reg_id=s.props.formData.reg_id:s.reg_id=0,s}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(le.jsxs)(S.a,{layout:"vertical",onFinish:function(t){return e.props.onFinish(t,e.reg_id)},ref:function(t){return e.formRef=t},initialValues:this.props.formData,children:[Object(le.jsx)(S.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"please input region name!",max:40}],children:Object(le.jsx)(C.a,{placeholder:"region name"})}),Object(le.jsx)(S.a.Item,{name:"access_key",label:"Access Key",rules:[{required:!0,message:"please input region name!",max:30}],children:Object(le.jsx)(C.a,{placeholder:"access key"})}),Object(le.jsx)(S.a.Item,{name:"secret_key",label:"Secret Key",rules:[{required:!0,message:"please input region name!",max:40}],children:Object(le.jsx)(C.a,{placeholder:"secret key"})}),Object(le.jsx)(S.a.Item,{name:"server",label:"Endpoint",rules:[{required:!0,message:"please backend endpoint address!",max:50}],children:Object(le.jsxs)($.b,{direction:"vertical",style:{width:"100%"},children:[Object(le.jsx)(C.a,{placeholder:"server address"}),Object(le.jsx)(H.a,{type:"info",message:this.state.endpoint_text})]})}),Object(le.jsx)(S.a.Item,{initialValue:"local",name:"type",label:"Type",rules:[{required:!0,message:"please choice type",max:10}],children:Object(le.jsxs)(Ge.a,{onChange:this.regionTypeChange,children:[Object(le.jsx)(Ge.a.Option,{value:"local",children:"Local"}),Object(le.jsx)(Ge.a.Option,{value:"amazon",children:"Amazon"})]})}),Object(le.jsx)(S.a.Item,{name:"state",label:"State",rules:[{required:!0,message:"please choice region state!",max:1}],children:Object(le.jsxs)(X.a.Group,{buttonStyle:"solid",style:{width:"100%",textAlign:"center"},children:[Object(le.jsx)(X.a.Button,{value:"e",style:{width:"50%"},children:"Enable"}),Object(le.jsx)(X.a.Button,{value:"d",style:{width:"50%"},children:"Disable"})]})})]})}}]),a}(n.Component),Ft=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).getRegionList=function(){A.a.get(n.globalState.domain+"/api/buckets/region",{headers:n.globalState.request_headers.headers}).then((function(e){return n.setState({data:e.data.data})}))},n.regionColumns=[{title:"Name",dataIndex:"name"},{title:"Access Key",dataIndex:"access_key"},{title:"Secret Key",dataIndex:"secret_key"},{title:"Endpoint",dataIndex:"server"},{title:"Type",dataIndex:"type"},{title:"Status",dataIndex:"state",render:function(e){return"e"===e?Object(le.jsx)(St.a,{status:"processing",text:"Enable"}):Object(le.jsx)(St.a,{status:"error",text:"Disable"})}},{title:"Action",dataIndex:"reg_id",render:function(e,t){return Object(le.jsxs)($.b,{children:[Object(le.jsx)(B.a,{icon:Object(le.jsx)(Ct.a,{}),onClick:function(e){return n.handleEditRegionEvent(e,t)},children:"Edit"}),Object(le.jsx)(B.a,{icon:Object(le.jsx)(It.a,{}),onClick:function(){return n.handleDeleteRegionEvent(e)},children:"Delete"})]})}}],n.drawerClose=function(){n.setState({drawer_title:null,drawer_content:null,visible:!1})},n.handleEditRegionEvent=function(e,t){n.setState({drawer_title:"Edit region",drawer_content:Object(le.jsx)(qt,{ref:function(e){return n.Child=e},formData:t,onFinish:n.onFinish}),visible:!0})},n.handleDeleteRegionEvent=function(e){k.a.confirm({icon:Object(le.jsx)(J.a,{}),title:"warning",okType:"danger",content:"Deleting region will delete all related buckets and objects",onOk:function(){A.a.delete(n.globalState.domain+"/api/buckets/region",{data:{reg_id:e},headers:n.globalState.request_headers.headers}).then((function(){q.b.success("success"),n.getRegionList()})).catch((function(e){e.response&&403===e.response.data.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.warning(e.response.data.detail)}))}})},n.handleAddRegionEvent=function(e){n.setState({drawer_title:"Add a new region",drawer_content:Object(le.jsx)(qt,{ref:function(e){return n.Child=e},onFinish:n.onFinish}),visible:!0})},n.onFinish=function(e,t){var a=n.globalState.domain+"/api/buckets/region",s=null;t>0&&(e.reg_id=t,s=A.a.put(a,e,n.globalState.request_headers)),0===t&&(s=A.a.post(a,e,n.globalState.request_headers)),null!==s&&s.then((function(){q.b.success("success"),n.setState({visible:!1}),n.getRegionList()})).catch((function(e){e.response&&403===e.response.data.status?(window.sessionStorage.setItem("user_info",null),window.location.reload()):q.b.warning(e.response.data.detail)}))},n.onSubmit=function(){n.Child.submit()},n.globalState=v.getState(),n.Child=s.a.createRef(),n.state={data:[],drawer_title:"",visisble:!1,drawer_content:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getRegionList()}},{key:"render",value:function(){return Object(le.jsxs)(Q.a,{title:"Region List",children:[Object(le.jsxs)(B.a,{type:"primary",style:{marginBottom:10},onClick:this.handleAddRegionEvent,children:[Object(le.jsx)(Ue.a,{}),"Add Region"]}),Object(le.jsx)(G.a,{dataSource:this.state.data,columns:this.regionColumns,rowKey:function(e){return e.reg_id}}),Object(le.jsx)(D.a,{title:this.state.drawer_title,onClose:this.drawerClose,visible:this.state.visible,width:500,closable:!0,footer:Object(le.jsx)("div",{style:{textAlign:"right"},children:Object(le.jsx)(B.a,{onClick:this.onSubmit,type:"primary",children:"Submit"})}),children:this.state.drawer_content})]})}}]),a}(n.Component),Dt=C.a.Search,Pt=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onSearch=function(e){n.child.getUserList(1,e)},n.child=s.a.createRef(),n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(le.jsx)(Q.a,{title:"User manage",children:Object(le.jsxs)(I.a,{gutter:[8,8],children:[Object(le.jsx)(R.a,{span:8,children:Object(le.jsx)(Dt,{placeholder:"input username",onSearch:this.onSearch,enterButton:!0})}),Object(le.jsx)(R.a,{span:24,children:Object(le.jsx)(xe,{type:"superuser",ref:function(t){return e.child=t}})})]})})}}]),a}(n.Component),At=Se.a.Content,Nt=Se.a.Sider,zt=E.a.SubMenu,Lt=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleLeftMenuClick=function(e){e.key in n.contents&&n.setState({content:n.contents[e.key]})},n.contents={users:Object(le.jsx)(Pt,{}),plan:Object(le.jsx)(Bt,{}),region:Object(le.jsx)(Ft,{}),role:Object(le.jsx)(kt,{})},n.state={content:n.contents.users},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(le.jsxs)(At,{style:{padding:"0 50px"},children:[Object(le.jsxs)(Re.a,{style:{margin:"16px 0"},children:[Object(le.jsx)(Re.a.Item,{children:"Home"}),Object(le.jsx)(Re.a.Item,{children:"Config"})]}),Object(le.jsxs)(Se.a,{className:"site-layout-background",style:{padding:"24px 0"},children:[Object(le.jsx)(Nt,{className:"site-layout-background",width:200,children:Object(le.jsxs)(E.a,{mode:"inline",defaultSelectedKeys:["users"],defaultOpenKeys:["sub1"],style:{height:"100%"},onClick:this.handleLeftMenuClick,children:[Object(le.jsxs)(zt,{icon:Object(le.jsx)(u.a,{}),title:"User",children:[Object(le.jsx)(E.a.Item,{icon:Object(le.jsx)(u.a,{}),children:"Users"},"users"),Object(le.jsx)(E.a.Item,{icon:Object(le.jsx)(ft.a,{}),children:"Role"},"role")]},"sub1"),Object(le.jsxs)(zt,{icon:Object(le.jsx)(gt.a,{}),title:"System",children:[Object(le.jsx)(E.a.Item,{icon:Object(le.jsx)(Ot.a,{}),children:"Plan & Price"},"plan"),Object(le.jsx)(E.a.Item,{icon:Object(le.jsx)(xt.a,{}),children:"Region"},"region")]},"sub2")]})}),Object(le.jsx)(At,{style:{marginLeft:8,minHeight:280},children:this.state.content})]})]})}}]),a}(n.Component),Mt=Se.a.Header,Ut=Se.a.Footer,Tt=Se.a.Content,Et=Object(le.jsx)(E.a,{children:Object(le.jsx)(E.a.Item,{children:Object(le.jsxs)(B.a,{style:{color:"black"},type:"link",onClick:function(){return ce()},children:[Object(le.jsx)(Ce.a,{}),"logout"]})})}),Vt=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handlerMenuClick=function(e){e.key in n.pages&&n.setState({content:n.pages[e.key]})},n.pages={dashboard:Object(le.jsx)(ze,{}),bucket:Object(le.jsx)(rt,{}),mine:Object(le.jsx)(mt,{}),config:Object(le.jsx)(Lt,{})},n.state={content:n.pages.dashboard},n.globalState=v.getState(),n}return Object(l.a)(a,[{key:"render",value:function(){return Object(le.jsxs)(Se.a,{children:[Object(le.jsx)(Mt,{className:"header",children:Object(le.jsxs)(I.a,{children:[Object(le.jsx)(R.a,{span:20,children:Object(le.jsxs)($.b,{align:"top",size:0,children:[Object(le.jsx)(M,{stroke:"white",height:63,style:{marginTop:14}}),Object(le.jsxs)(E.a,{theme:"dark",mode:"horizontal",onClick:this.handlerMenuClick,defaultSelectedKeys:"dashboard",children:[Object(le.jsx)(E.a.Item,{children:"Dashboard"},"dashboard"),Object(le.jsx)(E.a.Item,{children:"Bucket"},"bucket"),"superuser"===this.globalState.user_info.data.user_type?Object(le.jsx)(E.a.Item,{children:"Config"},"config"):null,Object(le.jsx)(E.a.Item,{children:"Mine"},"mine")]})]})}),Object(le.jsx)(R.a,{span:4,children:Object(le.jsx)(K.a,{overlay:Et,children:Object(le.jsxs)("a",{href:"#",style:{float:"right",color:"#fff"},className:"ant-dropdown-link",onClick:function(e){return e.preventDefault()},children:[this.globalState.user_info.data.first_name," ",Object(le.jsx)(Y.a,{})]})})})]})}),Object(le.jsx)(Tt,{id:"mainBody",style:{minHeight:document.documentElement.clientHeight-134},children:this.state.content}),Object(le.jsx)(Ut,{style:{textAlign:"center"},children:"FuRong Cloud Design \xa92021 Created by Ant UED"})]})}}]),a}(s.a.Component),Kt=(a(376),function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).globalState=v.getState(),n}return Object(l.a)(a,[{key:"render",value:function(){return null===this.globalState.user_info?Object(le.jsx)(ke,{}):Object(le.jsx)(Vt,{})}}]),a}(s.a.Component));a(559);r.a.render(Object(le.jsx)(Kt,{}),document.getElementById("root"))}},[[560,1,2]]]);
//# sourceMappingURL=main.0eb27965.chunk.js.map